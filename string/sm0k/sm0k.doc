
Zero-temperature (0K) String Method


STRIng ZERO [INITialize]}                                                                |
            [REPArameterize  [{DEFI <real>}] -
                             [{ITER <int>}] -
                             [{LINE | SPLI | BSPL | DST [{WNCT <real>}] | LIN2}] -
                             [{ORIE <atom-selection>} [{MASS}] ] -
                             [{MOVE <atom-selection>}] ]                                 |
            [STATistics      [{COUNt <int>]} -
                             [{ENER <energy_terms> [ENAM <character*>]}] -
                             [{RMSD [RNAM <character*>] [{RAPP}]} ] -
                             [{RMSA [RANM <character*>] [{RAAP}]} ] -
                             [{DELS [DNAM <character*>] [{DAPP}]} ] -
                             [{ORIE}] -
                             [{MASS}] -
                             [{ARCL [ANAM <character*>] [{AAPP}]} ] -
                             [{CURV [CVNM <character*>] [{CAPP}]} ] ]                    |
            [CONFormational Consistency}]                                                |
            [CHIRality}]                                                                 |
            [MINImize        [{REPF <int>}]  -
                             [{STAF <int>}]  -
                             [{CONFF <int>}] -
                             [{CHIRF <int>}] -
                             [{NOPR}]]                                                   |
            [INTErpolate     [{ METH [LINE|SPLI|BSPL]}] -
                             [NIN <int>] -
                             [NOUT <int>] -
                             [{CRIN <character*>} | {DCDIN <character*> [{BEGIn <int>}] [{STEP <int>}] } ] -
                             [OUTLIST <character*> | OUTBASE <character*> [{OUTI <int>}]] -
                             [{PDB [{RESI}] | FILE | UNFO | CARD | FORM}] -
                             [{ORIE <atom selection> [{MASS}]}] ]



--------------------------------------------------------------------------
[INIT] Initialize the zero-temperature string module. Substitution
parameters ?MESTRING and ?NSTRING will be set to correspond to the
string rank of each CPU group, and to the total number of string
replicas, respectively.

--------------------------------------------------------------------------
[REPA] Call reparametriation (Repa) module.

[LINE] Perform simple linear interpolation. This is the most stable and
preferred method.

[SPLI] Perform cubic spline interpolation. This method has very low
dissipation, and may cause the string curves corresponding to very
complex systems (and especially poorly resolved) systems to lengthen
indefinitely, preventing convergence.

[BSPL] Perform B-spline interpolation. This method introduces more
dissipation than the LINE method, and produces a smoother string curve.

[DST {WNCT <real> w \in [0..1] } ] Perform interpolation using the
Discrete Sine Transform described in reference [3].  This method
presently appears to offer no advantages over the other inbterpolation
methods above, is not often used, and thus should be considered
experimental. [WNCT <real>] specifies the wave number cut-off for the
DST method.  A value w implies that only the lowest w-fraction of
wavenumbers will be used to reconstruct the path by the inverse sine
transform. 

[LIN2] Exact (i.e. noniterative) linear interpolation in which
Newton-Raphson iterations are used to redistribute images such length
increments between adjacent images are exactly equal. Because the NR
iterations may fail to converge for very jagged strings, the method is
not generally recommended for long simulations.

[DEFI <real>] maximum allowed RMSD error in the distance between
adjacent replicas, defined as max_i RMSD[i,i+1]/RMSD[i,i-1]. The default
value is 1.1. A value <= 1.0 will cause the reparametrization to proceed
to the maximum number of iterations (see below).

[ITER <int> ] maximum number of reparametrization iterations. The
default value is 10.

NOTE: iterative reparameterization will continue until the
DEFI requirement is satisfied, or the maximum number of iterations is
exceeded. 'ITER 0' is allowed, and will cause the code to compute
information about the string parametrization without modifying it.

[ORIE {SELE <atom-selection> END}] atom selection that indicates that
the adjacent string replicas are to be superposed to miminize the RMSD
between atoms in the atom selection.  This option should typicaly be
present for rigid-body-invariant systems. The [MASS] specifies that the
orientation is to use mass-weighting.  Prior to reparameterization,
replica (i>1) will be rotated/translated such that the RMSD between the
orientation sets  of atoms of replicas (i) and (i-1) is minimized.
Replica coordinates will be restored to the original frame of reference
after reparametrization.

[MOVE {SELE <atom-selection> END}] atom selection that specifies the
parametrization of the string, i.e. those atoms to which
reparametrization will be applied.  Coordinates not included in teh
selection will not be affected by reparametrization.  The dafault option
is to MOVE all atom coordinates.

--------------------------------------------------------------------------
[STAT] Call statistics (Stat) module. Specify statistics options when
arguments are present. When called without arguments, an instance of
statistics output will be written out.

[COUNt <int>] specifies iteration counted for statistics output.  The
default value is 0.  This number is incremented after every call to
statistics, and  is printed in the output files corresponding to RMSD,
DELS, ARCL, and CURV. It is also appended to the base file name
specified by the [ENAM <character*>]

[ENER {<energy_terms>} [ENAM <character*>]] sets up output of energy values
along the path.  At each statistics call, the energy values corresponding
to the terms in {<energy_terms>} will be listed in one file per iteration, 
with one line of output per replica. The list {<energy_terms>} can contain
one or more energy substitution keywords described in energy.doc
(*note Energy:(chmdoc/energy.doc)).  The current iteration will be appended
to the base energy file name specified with [ENAM <character*>], followed by 
extension '.DAT'.  If ENAM is omitted, energy output is directed to the 
output stream.  This subcommand must be terminated by END.

[RMSD RNAM <character*> [RAPP]] sets up output of RMSD values between the
replica coordinates at the current iteration and the coordinates present in 
the comparison set (usually the initial string).  At each call to string 
statistics, a line will be added to the file with the name specified in
[RNAM <character*>], with the columns in the file corresponding to different 
replicas.  If RAPP is specified, output will be appended to the file.
If RNAM is omitted, RMSD output is directed to the output stream.
This subcommand is useful for gauging convergence of the string.

[RMSA RANM <character*> [RAAP]] sets up output of RMSD values between
the replica coordinates at the current iteration and the time-averaged
simulation coordinates of the replica.  At each call to string 
statistics, a line will be added to the file with the name specified in
[RNAM <character*>]. If RAAP is specified, output will be appended to
the file.

[DELS DNAM <character*> [DAPP]] sets up output of RMSD values between
the replica coordinates at the current iteration and those at the
previous iteration. At each call to string statistics, a line will be
added to the file with the  name specified with [DNAM <character*>].  If
DAPP is specified, output will be appended to the file.

[ORIE {MASS}] If ORIE is present, structures will be superposed to
minimize the RMSD between simulation and reference, averaged, and
previous structures. If MASS is present, orientation will use
mass-weighting. These keywords affect the behavior of options RMSD,
RMSA, and DELS only.

[ARCL ANAM <character*> [AAPP]] sets up output of the distance between 
the adjacent replicas (such that their sum yields the string length)  at
the current iteration.  At each call to string statistics, a line will
be added to the file with the name specified with [ANAM <character*>]. 
If AAPP is specified, output will be appended to the file.

[CURV CVNM <character*> [CAPP]] sets up output of the approximate
string curvature  at each string image.  At each call to string
statistics, a line will be added to the file with the name specified
with [CVNM <character*>].  If CAPP is specified, output will be appended
to the file.

--------------------------------------------------------------------------
[MINI] Perform string energy minimization using steepest descent (other
minimizers are supported indirectly at script level).

[REPF <int>]   Number of steps to skip between consecutive
reparametrizations. REPA options must be set prior to calling MINI.

[CHIRF <int>]  Number of steps between consecutive calls to conformational
consistency. CHIR options must be set prior to calling MINI.

[CONFF <int> ] Number of steps between consecutive calls to CONFCons
module. CONF options must be set prior to calling MINI.

[STAF <int>]  Number of reparametrization steps between consecutive
calls to statistics module, i.e. the number of minimization steps
between consecutive statistics to is <iSTATF> * <iREPF> .

[NOPR] Flag to limit non-essential string output from various modules
during minimization.
--------------------------------------------------------------------------

[INTE] Interpolate a string onto a new string with different resolution.
Useful for creating initial paths between known endpoints. 

[METH [LINE|SPLI|BSPL] ] interpolation method. Presently valid choices are LINE, SPLI,
BSPL (described above for REPA). The default is LINE.

[NIN] Number of coordinate sets in the existing string.

[NOUT] Number of coordinate sets in the interpolated string.

[CRIN <character*>] Name of text file which contains the filenames in
which existing coordinates are stored, with one file name per line.
This option is mutually exclusive with DCDIN.

[DCDIN <character*> [{BEGIn <int>}] [{STEP <int>}] } ] Name of
trajectory file which contains the existing string coordinates.  BEGIN
<int> specifies the frame number cprresponding to the first string image
(default: 1).  STEP <int> specifies the stride between adjacent string
images in the trajectory (default: 1).

[OUTLIST <character*> ] Indicates that output file names corresponding
the  interpolated string are to be found in a text file with the
provided name (one file name per line). This option is mutually
exclusive with  OUTBASE.

[OUTBASE] Indicates that output file names corresponding to the 
interpolated string are to be of the form <outbase><i>.cor;
CHARMM coordinate format will be used.  The indices <i> are computed as
i \in [<outi> .. <outi> + <nout> - 1], where :
[OUTI <int>outi ] specifies the initial index (default: 0)

The following options are passed to the CHARMM coordinate input/output
routines:

[PDB [{RESI}] ] Indicates that input/output coordinate files are in PDB
format.  RESI will pass the 'RESID' option to the coordinate reader.

[FILE | UNFO ] Indicates that input/output coordinate files are
UNFORMATTED.

[CARD | FORM}] Indicates that input/output coordinate files are
FORMATTED.

[ORIE {MASS}] If ORIE is present, structures will be superposed to
minimize the RMSD between adjacent string images prior to interpolation.
If MASS is present, orientation will use mass-weighting.
--------------------------------------------------------------------------

[CONF] Call conformational consistency (ConfCons) module. CONFcons
options can be set prior to calling using the CONFCons interface
described elsewhere in this file.

--------------------------------------------------------------------------

[CHIR] Call chirality (Chir) module. CONFcons options can be set prior
to calling using the CONFCons interface described elsewhere in this
file.

--------------------------------------------------------------------------

Chirality module

Description.

A simple chirality checker to find and correct chirality errors acording
to prescribed rules, applied to an optional atom selection. The
functionality is provided as part of the string module along with the
conformational consistency (CONFcons) module to correct coordinate
errors that occur when generating minimum energy paths using the 0K
string method.

Syntax.

 COOR CHIRality [{INIT}] [{FINA}] [{CHECK}] [{FIX}] [{NOFX}] [{NOPR}]
 [{PRIN}] [{HELP}] [{RULE}] [{PSEU}] {[PROP}] {<atom selection>}

Command reference.

[INIT ] initialize Chirality (also, reinitialize, erasing old rules).

[FINA ] finalize Chirality, deallocating all data.

[CHECK] check residues specified in the atom selection for errors

[FIX  ] attempt to correct Chirality errors found during checking.

[NOFX ] check for errors, but do not attempt to correct them

[NOPR ] produce minimal output (useful during 0K string minimizations).

[PRIN ] produce normal (verbose) output

[HELP ] print succinct command reference

[RULE ] print currently defined rules that will be applied to each
matching residue. The rule syntax is decsribed below.

[PSEU ] also check for pseudo-chirality errors (i.e. ordering of
hydrogens in a methyl group).

[PROP ] also check for pseudo-chirality in the Proline patch.

[READ  {UNIT} {ADD} ] read rules from unit (or from the input stream if unit is omitted).
 ADD will append new rules to the existing set of rules.
 
 Atom selection is optoinal, and all atoms will be selected by default.
 When present, each residue with at least one atom contained in the atom
 selection will be checked (i.e. BYRES keyword is implied in the
 selection)

Description of chirality rules.

Each chirality rule is a character string that contains the following in
order: Residue name <char*>, four atom types <char*>, a dihedral angle
threshold for determining whether the chirality is incorrect <real>, an
flag that determines the correct dihedral range, and names of two atoms which
specify the bond to be inverted in case of a chirality error.

For example, the rule 'ARG N C CB HA 0. -1 HA CA' indicates that the
dihedral angle  N-C-CB-HA in residue ARG must be less than zero 
Precisely, the inequality that is evaluated is [ phi(x) * (-1) > phi0 *
(-1) ],  where  phi0=0 and the flag "-1" implicitly specifies the valid
range, i.e. valid `side` of the inequality. If this rule is violated,
then the position of  atom HA will be reflected through the plane
perpendicular to the bond CA-HA at CA.

--------------------------------------------------------------------------

Conformational consistency module.

Description.

The CONFormational CONSistency module is applicable to groups of atoms
that have rotational symmetry because some of the constituent atoms are
indistinguishable, e.g. H1, H2, and H3 in a methyl group. In specifying
the coordinates of a molecule with such a group, the atoms can be
arranged in three completely equivalent ways, relative to a reference
conformation. These are H1/H2/H3, H2/H3/H1, H3/H1/H2. They are related
by rotations around the bond that involves the parent atom (e.g. methyl
carbon). Note that the conformation H1/H3/H2 is not allowed because it
corresponds to a change of (pseudo) chirality, which is assumed to be
fixed (see chirality module) The purpose of this module is to identify
all such symmetry groups in a molecular coordinate set and choose the
rotation that brings the coordinates into the closest proximity (in the
sense of a certain RMSD ) to the coordinates in a reference set. This is
done according to a set of rules, which can be specified by the user; a
default set for the charmm22 protein topology is defined in this module.

A description of the algorithm and the rules is provided in corman.doc.
When used with the 0K string method, the CONFcons module check
consistency for each pair of adjacent structures along the string.
--------------------------------------------------------------------------

References

[1] W. E, W. Ren, and E. Vanden-Eijnden, J. Chem. Phys. 126, 164103 (2007).
[2] V. Ovchinnikov, M. Karplus, and E. Vanden-Eijnden, J. Chem. Phys.
134, 085103 (2011).
[3] I. Khavrutskii, K. Arora, and C. Brooks III, J. Phys. Chem. 125, 174108
(2006).

If you find the CHARMM SM0K code useful in preparing a manuscript,
please cite the implementation reference 2 above.
