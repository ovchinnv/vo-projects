% compute dh from chest output
%
% experimental data
dhexp=[-125.8 -98.5 -78.4 -73.4 -67.6 -119.3 -85.3 -78.8 -69.0 -143.5 -115.1 -504.5 -462.4 -383.6 -348.3 -314.3 -491.6 -434.6 -439.4 -1118.1 -939.8 -868.6 -789.0 -1556.7 -853.5 -1124.1 -986.4 -77.2 -108.8 -325.0 -78.8]';
% data calculated by Honig 1985
dhh=[-126.7 -99.3 -76.8 -72.2 -66.3 -117.2 -86.1 -79.9 -71.2 -133.2 -116.3 -532.8 -458.4 -358.3 -324.7 -314.8 -498.7 -442.1 -432.9 -1122.7 -974.1 -865.8 -830.0 -1515.0 -852.2 -1122.1 -935.1 -77.9 -111.3 -338.8 -84.7]';

d=load('tmp.dat');
C=-1.357;
eout=80;
ein=1;
deps=0.1 ;

dg = d(:,3) - d(:,1)
dh = dg - C * eout * ( d(:,4) - d(:,2) ) / (2*deps)

figure(1); clf ; hold on; box on;
plot(dhexp,-dh,'ko')
plot(dhexp,dhh,'rv')

% errors :
err_chk = (dhexp+dh)./dhexp * 100;
max(abs(err_chk))
sqrt(mean(err_chk.^2))
