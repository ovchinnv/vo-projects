#!charmm
# test case for computing grid densities based on a molecule
# grid size
output {
 minwarnlev=-1 ! turn off fatal warnings
}

continuum {
 nx=98
 ny=98
 nz=98

 xgrid=object ; xbuffer=10 ; dxmin=1 ;
 ygrid=object ; ybuffer=10 ; dymin=1 ;
 zgrid=object ; zbuffer=10 ; dzmin=1 ;

! xstretchfix=no ! defaults to yes
! xoptimize=no ! to optimize grid size for multigrid solver, which requires maximizing powers of two in the grid size
! yoptimize=no
! zoptimize=no

 gridoutput=xyz.xyz
! output_mode=binary ! default is ascii
 output_format=plot3d

 exec: init
 exec: output

}

object {
 object=molecule
}

molecule{
 structure=traf-rank.psf
 parameters=par_all36_prot.prm
 coordinates=traf-rank.pdb
 coortype=pdb
 cutoff_surf_stdev=5 ! increasing this will define the density farther out ; not clear where this parameters belongs -- maybe ches ?
 kappa_solvent=0 ! ionic strength in the solvent region (M)
 eps_solute=1 ! protein dielectric
 eps_solvent=78 ! solvent dielectric
 eps_scale=none
}

ches{
! surfoutput=density.dat
! alloutput=data.dat
 rhsoutput=q.dat ! charge density
 epsoutput=eps.dat
! output_mode=binary ! default is ascii
 output_format=plot3d
 exec:init
 exec:output
}
