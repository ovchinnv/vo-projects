!charmm

continuum {
#Size
 nx=98; ny=98; nz=98
! nx=34; ny=34; nz=34

#Grid

 xgrid=exp; xstretch=1.0; x0=0; x1=1
 ygrid=exp; ystretch=1.0; y0=0; y1=1
 zgrid=exp; zstretch=1.0; z0=0; z1=1

#Continuum output options
 output_format=plot3d
 output_mode=text
 gridoutput=xyz_test.xyz

! exec:output
}

#Communicators
multicom {
 exec:set ches 1
}

object {
 object=molecule
}

molecule {
 structype=PQR ! note : would be good to have multple ways/keywords of specifying
 structure=born.pqr ! note that this file should have a single charge with radius 0 (unit mass)
 kappa_solute=0 ! note that could skip gaussian gridding if solute/solvent values are same
 kappa_solvent=0
 eps_solute=4
 eps_solvent=80
 eps_scale=none
 eps_padding=0.5 ! this is added to the radius to compute the eps array
 charge_padding=0 ! added to radius to compute smoothed right-hand-side
 stdev_eps=0.1 ! might be worthwhile to be able to set a single stdev
 stdev_charge=0.1
}

ches {
# BC
 phi_bcx0=dirichlet; phi_bcx0_file=xbc0_test.dat
 phi_bcx1=dirichlet; phi_bcx1_file=xbc1_test.dat
 phi_bcy0=dirichlet; phi_bcy0_file=ybc0_test.dat
 phi_bcy1=dirichlet; phi_bcy1_file=ybc1_test.dat
 phi_bcz0=dirichlet; phi_bcz0_file=zbc0_test.dat
 phi_bcz1=dirichlet; phi_bcz1_file=zbc1_test.dat

#Initial 3D data
! note that there is currently to functionality to initialize only a subset of variables (kappa, rhs, eps) from object
 epsinit=object
 kappainit=object
 rhsinit=object
 phiinit=constant   ; phiconst=0. ! initial solution

#Solver
 solver=multigrid

#Output
 output_format=chest
 output_mode=text
 phioutput=solution.dat
 epsoutput=eps.dat
 rhsoutput=rhs.dat

#Execution
 exec:init
 exec:solve
 exec:output
 exec:done
} ! ches

multigrid {
# multigrid solver parameters
 multigrid_maximum_cycles=4
 multigrid_smooth_iterations=8
 multigrid_maximum_levels=4
# multigrid_smoother=Jacobi
# multigrid_residual=1e-4 # for shorter running times
# multigrid_smoother=Jacobi-Tiled-LM
# multigrid_compute_ini_residual=no
# multigrid_skip_convergence_test=1
# multigrid_smoother_unroll=-1
 multigrid_omega=1.44
}


