#ifdef __DMOL
#ifndef __INDEX
#define __INDEX dmolselect
#endif
          isele=__INDX(comlyn, comlen, 'SELE' ,4)
          if (isele.eq.0) then
           __WRN(whoami, '"SELE" IS MISSING (WHY DID YOU CALL ME ?)')
          else
            _MSGBUF (1)=comlyn(isele:comlen)  ! part of string that begins with the selection
            i__=comlen-isele+1
            iend=__INDX(_MSGBUF (1),i__, 'END',3)   ! location of selection termination
            if (iend.eq.0) then
             __WRN(whoami, '"END" SELECTION TERMINATOR IS MISSING')
            else
             __INCR(iend,-1+isele)            ! corresponding index into comlyn starting from 1
             _MSGBUF (1)=comlyn(isele:iend-1) ! part of string that begins with the selection and ends before ' END'
             word__=pop_string(_MSGBUF (1)) ! remove first word (which we know is 'SELE*') from _MSGBUF
!     process selection:
             __FREE(__INDEX)
             __INDEX=>__GET_IND_FROM_SELECTION(_MSGBUF (1))
!     remove selection string from command line:
             _MSGBUF (1) =comlyn(iend:comlen)  ! command line starting with 'END' (see above) 
             word__=pop_string(_MSGBUF (1) )   ! remove 'END*' e.g. 'ENDING' is ok too
             comlyn(isele:)=_MSGBUF (1)        ! selection has been removed from command
             __INCR(comlen, isele-iend)
            endif ! iend
          endif ! isele
!#undef __INDEX
#endif
