! test calculations and approximations of the error function
!
  program test

  use erf_ext
! timer vars
 
  int :: icount, irate, imax, idiff
 
  int, parameter :: n=10000000 ! number of points
  float :: x0=-2d0, x1=2d0, emax, eave

  float, dimension(n) :: e_sun, e_c, e_native, e_o7, e_o5, x
   
  do i=1,n
    x(i)=rand()*(x1-x0)+x0
  enddo
  write(0,*) 'Calculating erf of',n,' numbers using the built-in erf ...'
  call system_clock(icount, irate, imax)
!
  do i=1,n
    e_native(i)=erf(x(i))
  enddo
 
  call system_clock(idiff, irate, imax); idiff=idiff-icount
!
  write(0,*) 'Clock time (s): ',1e0*idiff/irate

!--------------------------------------------------------------------------

  write(0,*) 'Calculating erf of',n,' numbers using erf from C...'
  call system_clock(icount, irate, imax)
!
  do i=1,n
    e_c(i)=erf_c(x(i))
  enddo
 
  call system_clock(idiff, irate, imax); idiff=idiff-icount
!
  write(0,*) 'Clock time (s): ',1e0*idiff/irate

!--------------------------------------------------------------------------

  write(0,*) 'Calculating erf of',n,' numbers using erf from SUN ...'
  call system_clock(icount, irate, imax)
!
  do i=1,n
    e_sun(i)=erf_sun(x(i))
  enddo
 
  call system_clock(idiff, irate, imax); idiff=idiff-icount
!
  write(0,*) 'Clock time (s): ',1e0*idiff/irate
!
!--------------------------------------------------------------------------
!
  write(0,*) 'Calculating erf of',n,' numbers using O(7) erf approximation  ...'
  call system_clock(icount, irate, imax)
!
  do i=1,n
    e_o7(i)=erfo7(x(i))
  enddo
 
  call system_clock(idiff, irate, imax); idiff=idiff-icount
!
  write(0,*) 'Clock time (s): ',1e0*idiff/irate
!
!--------------------------------------------------------------------------
!
  write(0,*) 'Calculating erf of',n,' numbers using O(5) erf approximation  ...'
  call system_clock(icount, irate, imax)
!
  do i=1,n
    e_o5(i)=erfo5(x(i))
  enddo
 
  call system_clock(idiff, irate, imax); idiff=idiff-icount
!
  write(0,*) 'Clock time (s): ',1e0*idiff/irate

!----------------------------------------------------------------------------
  write(0,*) '------------------------------------------------------------'
  write(0,*) 'Computing errors (built-in function is the reference) ...'
  emax=maxval(abs(e_native-e_c));   eave=sum(abs(e_native-e_c))/n
  write(0,'(A,G30.20,A1,G30.20,A1)') ' ERF from C (max/average) : (',emax,'/',eave,')'
  emax=maxval(abs(e_native-e_sun));   eave=sum(abs(e_native-e_sun))/n
  write(0,'(A,G30.20,A1,G30.20,A1)') ' ERF from SUN (max/average) : (',emax,'/',eave,')'
  emax=maxval(abs(e_native-e_o7));   eave=sum(abs(e_native-e_o7))/n
  write(0,'(A,G30.20,A1,G30.20,A1)') ' O(7) approximation (max/average) : (',emax,'/',eave,')'
  emax=maxval(abs(e_native-e_o5));   eave=sum(abs(e_native-e_o5))/n
  write(0,'(A,G30.20,A1,G30.20,A1)') ' O(5) approximation (max/average) : (',emax,'/',eave,')'
  write(0,*) '------------------------------------------------------------'
! 
end